"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/get";
exports.ids = ["pages/api/get"];
exports.modules = {

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "./pages/api/get.js":
/*!**************************!*\
  !*** ./pages/api/get.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _model__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./model */ \"./pages/api/model.js\");\n/* harmony import */ var _model__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_model__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst uri = process.env.MongoSecret;\nmongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(uri, {\n    useNewUrlParser: true,\n    useUnifiedTopology: true\n});\nconst db = (mongoose__WEBPACK_IMPORTED_MODULE_0___default().connection);\ndb.on(\"error\", console.error.bind(console, \"connection error: \"));\ndb.once(\"open\", function() {\n    console.log(\"Connected to Mongo\");\n});\nasync function handler(req, res) {\n    const { requestCount , keywords , id  } = req.body;\n    if (req.method === 'GET') {\n        let data = await _model__WEBPACK_IMPORTED_MODULE_1___default().find({}, {\n            _id: 1\n        });\n        let paths = data.map((item)=>{\n            return item._id.valueOf();\n        });\n        res.status(200).json(paths);\n        return;\n    } else if (id) {\n        console.log(id);\n        let data = await _model__WEBPACK_IMPORTED_MODULE_1___default().findOne({\n            _id: id\n        });\n        let hits = data.hits ? parseInt(data.hits) + 1 : 1;\n        await _model__WEBPACK_IMPORTED_MODULE_1___default().findByIdAndUpdate(id, {\n            hits: hits\n        });\n        res.status(200).json(data);\n    } else {\n        let posts = await _model__WEBPACK_IMPORTED_MODULE_1___default().find({\n            $or: [\n                {\n                    \"title\": {\n                        $regex: keywords ? keywords.trim().length > 0 ? new RegExp(keywords.trim()) : \".*\" : \".*\",\n                        $options: 'i'\n                    }\n                },\n                {\n                    \"author\": {\n                        $regex: keywords ? keywords.trim().length > 0 ? new RegExp(keywords.trim()) : \".*\" : \".*\",\n                        $options: 'i'\n                    }\n                },\n                {\n                    \"date\": {\n                        $regex: keywords ? keywords.trim().length > 0 ? new RegExp(keywords.trim()) : \".*\" : \".*\",\n                        $options: 'i'\n                    }\n                }\n            ]\n        }).sort({\n            hits: -1\n        }).limit(3).skip(requestCount >= 0 ? requestCount * 10 : 0);\n        res.status(200).json({\n            posts\n        });\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLENBQUM7Z0JBQUMsQ0FBQztnQkFBRSxDQUFDO29CQUFDLENBQU0sT0FBRSxDQUFDO3dCQUFDSixNQUFNLEVBQUduQixRQUFRLEdBQUtBLFFBQVEsQ0FBQ29CLElBQUksR0FBR0MsTUFBTSxHQUFHLENBQUMsR0FBSSxHQUFHLENBQUNDLE1BQU0sQ0FBQ3RCLFFBQVEsQ0FBQ29CLElBQUksTUFBTSxDQUFJLE1BQUcsQ0FBSTt3QkFBRUcsUUFBUSxFQUFFLENBQUc7b0JBQUMsQ0FBQztnQkFBQyxDQUFDO1lBQUEsQ0FBQztRQUFDLENBQUMsRUFBRUMsSUFBSSxDQUFDLENBQUM7WUFBQ1YsSUFBSSxHQUFHLENBQUM7UUFBQyxDQUFDLEVBQUVXLEtBQUssQ0FBQyxDQUFDLEVBQUVDLElBQUksQ0FBRTNCLFlBQVksSUFBSSxDQUFDLEdBQUlBLFlBQVksR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNqZkQsR0FBRyxDQUFDYSxNQUFNLENBQUMsR0FBRyxFQUFFQyxJQUFJLENBQUMsQ0FBQztZQUFDSyxLQUFLO1FBQUMsQ0FBQztJQUM5QixDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2FwcC8uL3BhZ2VzL2FwaS9nZXQuanM/NmYyNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xuaW1wb3J0IFBvc3RzIGZyb20gJy4vbW9kZWwnO1xuY29uc3QgdXJpID0gcHJvY2Vzcy5lbnYuTW9uZ29TZWNyZXRcbm1vbmdvb3NlLmNvbm5lY3QodXJpLFxuICAgIHtcbiAgICAgICAgdXNlTmV3VXJsUGFyc2VyOiB0cnVlLFxuICAgICAgICB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWVcbiAgICB9XG4pO1xuY29uc3QgZGIgPSBtb25nb29zZS5jb25uZWN0aW9uO1xuZGIub24oXCJlcnJvclwiLCBjb25zb2xlLmVycm9yLmJpbmQoY29uc29sZSwgXCJjb25uZWN0aW9uIGVycm9yOiBcIikpO1xuZGIub25jZShcIm9wZW5cIiwgZnVuY3Rpb24gKCkge1xuICAgIGNvbnNvbGUubG9nKFwiQ29ubmVjdGVkIHRvIE1vbmdvXCIpO1xufSk7XG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XG4gICAgY29uc3QgeyByZXF1ZXN0Q291bnQsIGtleXdvcmRzLGlkfSA9IHJlcS5ib2R5O1xuICAgIGlmIChyZXEubWV0aG9kPT09J0dFVCcpIHtcbiAgICAgICAgbGV0IGRhdGEgPSBhd2FpdCBQb3N0cy5maW5kKHt9LCB7IF9pZDogMSB9KVxuICAgICAgICBsZXQgcGF0aHMgPSBkYXRhLm1hcCgoaXRlbSkgPT4geyByZXR1cm4gaXRlbS5faWQudmFsdWVPZigpIH0pXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHBhdGhzKVxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGVsc2UgaWYoaWQpe1xuICAgICAgICBjb25zb2xlLmxvZyhpZClcbiAgICAgICAgbGV0IGRhdGE9YXdhaXQgUG9zdHMuZmluZE9uZSh7X2lkOmlkfSk7XG4gICAgICAgIGxldCBoaXRzPShkYXRhLmhpdHMpP3BhcnNlSW50KGRhdGEuaGl0cykrMToxO1xuICAgICAgICBhd2FpdCBQb3N0cy5maW5kQnlJZEFuZFVwZGF0ZShpZCx7aGl0czpoaXRzfSlcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oZGF0YSlcbiAgICB9XG4gICAgZWxzZXtcbiAgICBsZXQgcG9zdHMgPSBhd2FpdCBQb3N0cy5maW5kKHsgJG9yOiBbeyBcInRpdGxlXCI6IHsgJHJlZ2V4OiAoa2V5d29yZHMpID8gKGtleXdvcmRzLnRyaW0oKS5sZW5ndGggPiAwKSA/IG5ldyBSZWdFeHAoa2V5d29yZHMudHJpbSgpKSA6IFwiLipcIiA6IFwiLipcIiwgJG9wdGlvbnM6ICdpJyB9IH0sIHsgXCJhdXRob3JcIjogeyAkcmVnZXg6IChrZXl3b3JkcykgPyAoa2V5d29yZHMudHJpbSgpLmxlbmd0aCA+IDApID8gbmV3IFJlZ0V4cChrZXl3b3Jkcy50cmltKCkpIDogXCIuKlwiIDogXCIuKlwiLCAkb3B0aW9uczogJ2knIH0gfSwgeyBcImRhdGVcIjogeyAkcmVnZXg6IChrZXl3b3JkcykgPyAoa2V5d29yZHMudHJpbSgpLmxlbmd0aCA+IDApID8gbmV3IFJlZ0V4cChrZXl3b3Jkcy50cmltKCkpIDogXCIuKlwiIDogXCIuKlwiLCAkb3B0aW9uczogJ2knIH0gfV0gfSkuc29ydCh7IGhpdHM6IC0xIH0pLmxpbWl0KDMpLnNraXAoKHJlcXVlc3RDb3VudCA+PSAwKSA/IHJlcXVlc3RDb3VudCAqIDEwIDogMCk7XG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBwb3N0cyB9KVxuICAgIH1cbn0iXSwibmFtZXMiOlsibW9uZ29vc2UiLCJQb3N0cyIsInVyaSIsInByb2Nlc3MiLCJlbnYiLCJNb25nb1NlY3JldCIsImNvbm5lY3QiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJkYiIsImNvbm5lY3Rpb24iLCJvbiIsImNvbnNvbGUiLCJlcnJvciIsImJpbmQiLCJvbmNlIiwibG9nIiwiaGFuZGxlciIsInJlcSIsInJlcyIsInJlcXVlc3RDb3VudCIsImtleXdvcmRzIiwiaWQiLCJib2R5IiwibWV0aG9kIiwiZGF0YSIsImZpbmQiLCJfaWQiLCJwYXRocyIsIm1hcCIsIml0ZW0iLCJ2YWx1ZU9mIiwic3RhdHVzIiwianNvbiIsImZpbmRPbmUiLCJoaXRzIiwicGFyc2VJbnQiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsInBvc3RzIiwiJG9yIiwiJHJlZ2V4IiwidHJpbSIsImxlbmd0aCIsIlJlZ0V4cCIsIiRvcHRpb25zIiwic29ydCIsImxpbWl0Iiwic2tpcCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./pages/api/get.js\n");

/***/ }),

/***/ "./pages/api/model.js":
/*!****************************!*\
  !*** ./pages/api/model.js ***!
  \****************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst mongoose = __webpack_require__(/*! mongoose */ \"mongoose\");\nconst Schema = new mongoose.Schema({\n    author: {\n        type: String,\n        required: true\n    },\n    title: {\n        type: String,\n        required: true\n    },\n    content: {\n        type: String\n    },\n    tags: {\n        type: Array\n    },\n    hits: {\n        type: Number\n    },\n    date: {\n        type: String\n    }\n});\nconst Posts = mongoose.models.postrb || mongoose.model(\"postrb\", Schema);\nmodule.exports = Posts;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWdlcy9hcGkvbW9kZWwuanMuanMiLCJtYXBwaW5ncyI6IjtBQUFBLEtBQUssQ0FBQ0EsUUFBUSxHQUFHQyxtQkFBTyxDQUFDLDBCQUFVO0FBQ25DLEtBQUssQ0FBQ0MsTUFBTSxHQUFHLEdBQUcsQ0FBQ0YsUUFBUSxDQUFDRSxNQUFNLENBQUMsQ0FBQztJQUNoQ0MsTUFBTSxFQUFFLENBQUM7UUFDTEMsSUFBSSxFQUFFQyxNQUFNO1FBQ1pDLFFBQVEsRUFBRSxJQUFJO0lBQ2xCLENBQUM7SUFDREMsS0FBSyxFQUFDLENBQUM7UUFDSEgsSUFBSSxFQUFFQyxNQUFNO1FBQ1pDLFFBQVEsRUFBRSxJQUFJO0lBQ2xCLENBQUM7SUFDREUsT0FBTyxFQUFFLENBQUM7UUFDTkosSUFBSSxFQUFFQyxNQUFNO0lBQ2hCLENBQUM7SUFDREksSUFBSSxFQUFFLENBQUM7UUFDSEwsSUFBSSxFQUFFTSxLQUFLO0lBQ2YsQ0FBQztJQUNEQyxJQUFJLEVBQUUsQ0FBQztRQUNIUCxJQUFJLEVBQUVRLE1BQU07SUFDaEIsQ0FBQztJQUNEQyxJQUFJLEVBQUMsQ0FBQztRQUNGVCxJQUFJLEVBQUVDLE1BQU07SUFDaEIsQ0FBQztBQUNMLENBQUM7QUFFRCxLQUFLLENBQUNTLEtBQUssR0FBR2QsUUFBUSxDQUFDZSxNQUFNLENBQUNDLE1BQU0sSUFBSWhCLFFBQVEsQ0FBQ2lCLEtBQUssQ0FBQyxDQUFRLFNBQUVmLE1BQU07QUFFdkVnQixNQUFNLENBQUNDLE9BQU8sR0FBR0wsS0FBSyIsInNvdXJjZXMiOlsid2VicGFjazovL2FwcC8uL3BhZ2VzL2FwaS9tb2RlbC5qcz9iNTcxIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcbmNvbnN0IFNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xuICAgIGF1dGhvcjoge1xuICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgdGl0bGU6e1xuICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgY29udGVudDoge1xuICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgfSxcbiAgICB0YWdzOiB7XG4gICAgICAgIHR5cGU6IEFycmF5LFxuICAgIH0sXG4gICAgaGl0czoge1xuICAgICAgICB0eXBlOiBOdW1iZXIsXG4gICAgfSxcbiAgICBkYXRlOntcbiAgICAgICAgdHlwZTogU3RyaW5nLFxuICAgIH1cbn0pO1xuXG5jb25zdCBQb3N0cyA9IG1vbmdvb3NlLm1vZGVscy5wb3N0cmIgfHwgbW9uZ29vc2UubW9kZWwoXCJwb3N0cmJcIiwgU2NoZW1hKTtcblxubW9kdWxlLmV4cG9ydHMgPSBQb3N0czsiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiU2NoZW1hIiwiYXV0aG9yIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwidGl0bGUiLCJjb250ZW50IiwidGFncyIsIkFycmF5IiwiaGl0cyIsIk51bWJlciIsImRhdGUiLCJQb3N0cyIsIm1vZGVscyIsInBvc3RyYiIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./pages/api/model.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("./pages/api/get.js"));
module.exports = __webpack_exports__;

})();